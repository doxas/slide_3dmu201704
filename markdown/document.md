
#### 自己紹介

杉本 雅広（すぎもと まさひろ）

ウェブでは主に doxas で活動。WebGL おじさんです。

![](sample.png)

<a href="https://twitter.com/h_doxas" target="_blank">@h_doxas</a>

---

#### 本日のテーマ

**WebGL 2.0 がやってくるぞ！**

---

#### 本日のテーマ

**WebGL 2.0 がやってくるぞ！**

な、なんだってー！

（まだ WebGL 1.0 だってよくわかってないのに……）

---

#### 本日のテーマ

**WebGL 2.0 がやってくるぞ！**

な、なんだってー！

（まだ WebGL 1.0 だってよくわかってないのに……）

<span class="capt">誰かの心の声を代弁しました</span>

---

#### 本日のテーマ

WebGL 2.0 はとても難産ではありましたが、最新のモダンブラウザは既にサポートを開始しており、ある程度ふつうに使っていける段階に入りました。

今日はそんな WebGL 2.0 が登場することによって、これから先のウェブはどのように変わっていくのか……

といったあたりをテーマに、いくつか新機能も紹介しながらお話できたらなと思っています。

---

#### WebGL 1.0

WebGL 1.0 が登場したのは 2011 年。

---

#### WebGL 1.0

2011 年というと、タイガーマスクを名乗る有志からの寄付が話題になったり、なでしこジャパンが世界一になったりしたらしいですが、私はその頃はまだ倉庫でダンボールにガムテープでフタをしつつ、フォークリフトでブイブイいわせる簡単なお仕事していましたので、あまり記憶が無いです。

---

#### WebGL 1.0

2011 年というと、タイガーマスクを名乗る有志からの寄付が話題になったり、なでしこジャパンが世界一になったりしたらしいですが、私はその頃はまだ倉庫でダンボールにガムテープでフタをしつつ、フォークリフトでブイブイいわせる簡単なお仕事していましたので、あまり記憶が無いです。

![](002.png)

---

#### 少しだけ自分の話

さりとて、私個人は 2012 年のはじめころから、WebGL について勉強したことをサイトにアウトプットするなどの活動を始めていたようです。

当時の私は、3D 系の API としては DirectX をかすかに触ったことがあった程度で、実は JavaScript 書いたこととか無かったので、結構大変でした。wgld.org の初期のころのサンプルやテキストを見ると、初々しいといいますか、ぶっちゃけおかしなこと言ってるところとかもあったりして興味深いです（やばい）

---

#### 少しだけ自分の話

ちなみに、3D の素養については DirectX ベースでしたが、当時すごくぶっきらぼうかつ大胆に解説してくれている神のようなサイトがありまして、そこで勉強しました。

---

#### 少しだけ自分の話

ちなみに、3D の素養については DirectX ベースでしたが、当時すごくぶっきらぼうかつ大胆に解説してくれている神のようなサイトがありまして、そこで勉強しました。

まあそのサイトってのは *もんしょの巣穴* というサイトなんですが、まだウブだった私は、勉強会を主催するどころかウェブというものにすら慣れていなかったので、恐る恐るサイトに記載されていたメールアドレス宛に「こんな素晴らしいサイト作ってくれてありがとうございます！」という感謝の気持ちを込めたメッセージを出しました。

---

#### 少しだけ自分の話

そうしたら、サイトに書かれている解説文の、ぶっきらぼうでワイルドな文面からは想像もできないような真心こもった温かいメッセージを巣穴の住人様が返してくださいまして、私は大変感動致しました。

いやこれマジ話です。

<span class="capt">もんしょさんと一緒に登壇できるなんて……夢にも思いませんでしたｗ</span>

---

#### WebGL 1.0

さて、話が脱線しました。

まず最初は、これまでの WebGL、つまり WebGL 1.0 について簡単におさらいしていきましょう。

---

#### WebGL 1.0

WebGL は皆さんがご存知のとおり、OpenGL ES というモバイル向けの軽量な OpenGL 実装を元にした JavaScript の API です。やんわりと、PS2 相当くらいの機能性でしょうか。

これが、WebGL 2.0 になると、元になっている OpenGL ES の後継バージョンを元にした形になり、純粋に新しい機能等を利用できるようになります。

---

#### WebGL 1.0

![](004.jpg)

<span class="capt">OpenGL ES 2.0 ベースから 3.0 ベースに。</span>

---

#### とは言え

元になっている OpenGL ES のバージョンがひとつ繰り上がり、高機能化した WebGL 2.0 ですが、フロントエンドエンジニア的目線で見た場合に、この進化は果たしてどれほどのメリットがあるのでしょうか。

劇的に、WebGL が使いやすくなるとか？

いえ、むしろ逆なんじゃないかなと私は思っています。

---

#### 3D プログラミング

WebGL は JavaScript で記述できますが、中身はほぼ OpenGL そのままです。

言い換えると *3D プログラミングをそのまま行うのと同じだけの知識や経験* が必要となります。

3D プログラミングのスキルと言えば、それ単体で飯のタネになるレベルの、なかなか修得が難しい分野ですよね。これをウェブや JavaScript 全般の知識と合わせて修得していくのは、普通に考えて並大抵のことでは無いと言えます。

<span class="capt">WebAssembly とかもそういう雰囲気がありますよね。</span>

---

#### 3D プログラミング

ちょっと悲しい表現になってしまいますが、WebGL 2.0 になったことによって、フロントエンドエンジニアが得られるメリットは *直接的にはほぼ無い* と考えていいと思います。

これは先に述べたとおり、WebGL がバージョンアップすることによるメリットは「3D 野郎からすれば大変うれしい」ものではあるけれども、3D の専門知識がない人にとっては難しすぎたり、高度すぎて必要なかったりする場合が多いと考えられるからです。

---

#### 使い手や使い方の変化

しかし、そのような現実も、見方を変えてみればまんざら悪いものと言うわけでもないと思います。

この場にいらっしゃるような、3D 系のクリエイターさんたちにとっては、WebGL が進化することはそれがそのまま活躍できるマーケットの拡大を意味します。

<span class="capt">どういうことなの？</span>

---

#### 使い手や使い方の変化

正直な話、WebGL は 2.0 になったとしても、3D 関連の技術のなかではかなり貧弱な部類に入ると思います。それでも、WebGL 1.0 から 2.0 にバージョンが上がったことで、たとえばわかりやすいところだと 3D テクスチャが使えるようになったり、あるいは transform feedback によるシェーダを利用した高速な処理が可能になったり、さりげなくですが、確実に進化しています。

数年のうちには、コンピュートシェーダがウェブにやってくると思いますので、そうなるとまた可能性も広がっていきます。

---

#### 使い手や使い方の変化

本格的で最新鋭の 3D API や機能を扱っている人からすると、WebGL はまるでオモチャのように頼りない存在だったと思います。まあそれは、2.0 でも変わらないかなｗ

一方で、フロントエンドの人達からすると、WebGL は 1.0 でも既に難し過ぎて、three.js なしで WebGL を記述できる人は相当限られています。

こんなどっちつかずな感じの扱いにならざるを得ないのが、WebGL の悲しいところです。

---

#### 使い手や使い方の変化

でもこれからは、WebGL が 2.0 に正統進化したように、少しずつでも WebGL やそれを取り巻く環境が変化していくと思います。

たとえば Unity や UE4 といったゲームエンジンがウェブにより対応しやすくなったり、WebVR のような WebGL と組み合わせることで進化を発揮する API が登場してきたりと、ウェブというところにはいろんな可能性が転がっていると思います。

---

#### 使い手や使い方の変化

![](003.jpg)

引用元：<a href="https://dev.mozilla.jp/2016/06/exporting-an-indie-unity-game-to-webvr/" target="_blank">Unity で作ったインディーゲームの WebVR 出力 | Mozilla Developer Street (modest)</a>

---

#### 使い手や使い方の変化

そういうふうに考えてみると、やはり 3D になにかしらの形で関わっている人達にとって、WebGL 2.0 の登場は、目立たないけれども、重要な進化のひとつの過程だと私は思います。

みなさんが生み出した作品や、技術は、もっと直接的にウェブブラウザを通じて世界中に影響を与えるようになっていくと思います。

それって、きっととても素晴らしいことなんじゃないかなと私は感じています。

---

#### 

---


#### WebGL 2.0

さて、精神論ばかりを語っても仕方がないので、少し具体的に技術の話をしてみます。

普段は、どうしても相手がフロントエンドエンジニアとなるような場所で登壇することが多くて、そういうところではあんまり 3D 界隈の専門用語とか使わないようにするんですが、むしろ今日はみんな私なんかよりもわかってそうな人達ばかりだと思いますので、普通にキーワードを選抜しながら見ていきましょう。

---

#### WebGL 2.0

まず、WebGL 2.0 についておさらいすると、WebGL は OpenGL ES をベースにした API で、細かい部分でいろいろ違いはあるとは言え、ほとんど OpenGL ES が持つ API をそのまま使うようなイメージです。

WebGL 1.0 は ES の 2.0 ベースでしたが、これが単純にバージョンアップして、WebGL 2.0 は OpenGL ES 3.0 ベースになります。

これは先述のとおりです。

---

#### WebGL 2.0

OpenGL のファミリー全般に詳しい方であればわかるかと思いますが、OpenGL ES 3.0 では、ジオメトリシェーダ等はサポートされていません。この流れは WebGL でもそのまま受け継がれているので、WebGL は 2.0 になったからと言って新しいシェーダは増えません。

個人的にはジオメトリシェーダ以降のシェーダ機構は、ウェブには永遠にやってこないんじゃないかなとか思ってしまいますが、どうでしょう。

もしかしたら、数年後にはウェブでジオメトリシェーダやテッセレーションシェーダが使えるようになるのかもしれませんが、結構難しいのかなという気がしています。

<span class="capt">あまりにも簡単にブラウザから PC 本体を殺せるもんね……</span>

---

#### WebGL 2.0

コンピュートシェーダについては、WebGL を管轄する Khronos グループが公式に対応を検討中ですみたいなことを言ってましたので、そのうち乗ると思います。

楽しみですね。

参考：<a href="https://www.khronos.org/blog/webgl-2.0-arrives" target="_blank">WebGL 2.0 Arrives - Khronos Developer Blog</a>

---

#### WebGL 2.0 の注目トピック

さて、それでは具体的にどのような新しいトピックがあったのか見ていきましょう。

どんな部分に、どんなふうに注目するのかは、人によって各々に違いはあるかなと思いますが、概ね次のような技術が新しく使えるようになっています。

---

#### WebGL 2.0 の注目トピック

* GLSL ES 3.0 をサポート
* MRT（Multiple Render Targets）を標準でサポート
* 多くの新しい Texture Format をサポート
* VAO、UBO、SamplerObject などの新しいバッファやオブジェクト
* Query 系処理のサポート
* インスタンシング描画の標準サポート
* transform feedback

---

#### GLSL ES 3.0

WebGL 2.0 では、従来からある WebGL 1.0 向けのシェーダは *そのまま使えます*。

ただし、シェーダのソースコード側に明示的にバージョン指定を行なっておけば、GLSL も新しいバージョンとなる ES 3.0 を使うことができます。

要するに、現在ブラウザ上で実際に動いているシェーダ群は、突然使えなくなったりすることはなく、あくまでも明示的に新しい GLSL を使うことを示した場合にのみ ES 3.0 が使われる形になります。

---

#### GLSL ES 3.0

新しい GLSL では、これまでよりも多くの関数が使えるようになったり、新しい演算子や構文が使えるようになったりしており、かなりいろいろな部分で変更があります。

特にもともと WebGL 使ってた人が混乱しそうなのは `attribute` や `varying` といった修飾子つきの変数が *一切使えなくなり*、全て `in` と `out` で表現する形になったことかなと思います。

`layout` 修飾子による変数のロケーションの任意指定や UBO（Uniform Buffer Object）を利用した構造体のような uniform 変数の定義など、まあいろいろとあります。

---

#### GLSL ES 3.0

もしこの中に WebGL 割と業務とかで使うかもという方がいらっしゃったら（いないかｗ）、今後は極力 GLSL ES 3.0 を使った記述を使っていくことを個人的にはおすすめします。

単純に機能が強力であることはもちろんですが、GLSL ES 3.0 を使わないと利用できない WebGL 2.0 の機能がいろいろあり、こっちに慣れておくほうが都合がいいのかなと感じています。

---

#### MRT（Multiple Render Targets）

MRT は遅延シェーディングとかに使われることが多いでしょうか。

これが登場してきたことにより、これまでの WebGL 1.0 では騙し騙しやっていたいくつかの技術がより簡潔に実装できるようになりますね。

もともと拡張機能としては提供されていたのですが、WebGL 2.0 になって標準に格上げになり、より安心して使えるようになりました。

---

#### MRT（Multiple Render Targets）

遅延シェーディング（Deferred Shading）については、概念を理解するだけなら以下がとても参考になるかなと思います。

参考：<a href="http://enginetrouble.net/2014/10/classic-deferred-shading-2014.html" target="_blank">古典的な遅延シェーディングの秋 2014 - Engine Trouble</a>

<span class="capt">ここにいる方々にとっては今更感が強いかもしれないですが……</span>

---

#### 多くのテクスチャフォーマット

WebGL 1.0 と比較して最も変更が多いのがこのテクスチャフォーマットだと思います。

3D テクスチャや 2D テクスチャ配列などが使えるようになっただけでなく、ビット数の多い Float テクスチャが使えたりと、いろいろ便利になっています。

WebGL 1.0 では Float Texture ですら拡張機能扱いだったので、やっと普通の水準になったかなという感じかもですけど。

---

#### VAO や UBO など

他にも拡張機能から格上げになったものがいろいろとあるのですが、VAO（Vertex Array Object）とかは、単純に便利になるのでぜひ使っていきたい機能じゃないでしょうか。

頂点バッファをバインドしてインデックスバッファをバインドしてみたいに、複数の手順をいちいち実行しなければならなかった WebGL 1.0 に比べ、VAO が使える WebGL 2.0 ではバインド周りの処理がかなり簡易化されます。

uniform 変数もバッファに入れられるようになったし、ブラウザ上で動くモデリング系のアプリケーションがより高速化するかもしれません。

---

#### Query 系の処理

これまでの WebGL 1.0 では、オクルージョンカリングみたいなことは API 的に実現できませんでしたが、WebGL 2.0 ならできます。

いまどきの 3DCG 界隈ではまあ当たり前のことが、WebGL 2.0 でやっと普通に使えるようになってきた、という感じではありますが、これはこれで大きな進歩かなと感じています。

---

#### インスタンシング

大量に同じジオメトリを描く際に高い効果を発揮するインスタンシング処理。

これも WebGL 1.0 では拡張機能扱いでしたが標準でサポートされるようになりました。

物量感溢れるデモがより作りやすくなりましたね。

---

#### transform feedback

コンピュートシェーダこそありませんが、WebGL 2.0 には transform feedback がありますので、シェーダを使っていろいろ楽しいことができるようになっています。

transform feedback は簡単に言うと VBO から抜き出した attribute の情報を、再度別の VBO に書き戻すことができる機能なので、GPU 上で様々な計算を行いぶん回していくことが可能です。

GPGPU 的なことがよりやりやすくなったという感じですね。

---

#### transform feedback

パーティクルをぐりぐり動かすみたいなのは、かなりやりやすくなりました。

![](005.jpg)

---

#### 


---

#### これからウェブはどうなっていくのだろう

さてさて、こんな感じでいろいろと新しいトピックに満ちている WebGL 2.0 ですが、じゃあ実際問題として、これらの新機能がウェブにもたらすものってなんなのでしょうか。

今年はめちゃくちゃすごい WebGL デモが入り乱れるように登場するんでしょうか？

まあ普通に考えて、そんなことはないと思います。

---

#### これからウェブはどうなっていくのだろう

というのは、WebGL はそもそもが、ウェブ屋さんたちには難しすぎて使いこなせないんですね。（少なくとも私はそう感じています）

ですから WebGL が新しくなって喜んでいるのはむしろ、もともと WebGL や OpenGL を使える 3D 野郎の一部だけで、ウェブ界隈では全然 WebGL の話が盛り上がっていたりはしません。

<span class="capt">ちょっとかなしい……</span>

---

#### これからウェブはどうなっていくのだろう

しかし、WebGL 2.0 の恩恵は、やはり多くの人にとって遅かれ早かれ意味のあるものになっていくと思っています。

たとえば、Unity などのゲームエンジンの存在があります。

---

#### 進化し続けるウェブとウェブ開発

いきなり Unity とか持ち出しちゃいましたが、極端な話、数年後には手書きでコード書いてる人なんてほとんどいないかもしれない。

大げさでしょうか？ 私はそうは思いません。

---

#### 進化し続けるウェブとウェブ開発

ウェブのインターフェースは全て GUI を持つアプリケーションで素早く構築することができ、それらを使いこなすことが我々の仕事になっているかもしれないし、それは現実に十分起こり得ることだと思います。

フロントエンドにはゲームエンジンを扱うことが専門のエンジニアがいて、HTML コーダーやデザイナーさんたちと連携しながらウェブサイトを作っていく、というのも普通にあり得ることだと思います。

---

#### 参考

Unity 出力の WebGL を利用したウェブサイトの一例です。

<a href="http://tsukishiro.diverse.jp/" target="_blank">Everything: Tsukishiro Hikari 1st Solo Album</a>

![](001.jpg)

---

#### 

---

#### まとめ

WebGL 1.0 が登場してから 6 年。やっと、WebGL 2.0 が出てきそうな感じになってきて、正直なところかなり時間が掛かったなという気がしています。

しかし先にも述べたとおりで、時間は掛かりはしたものの、正しく次のステップに進むことができたという事実が、個人的には非常に重要だと思っています。

---

#### まとめ

WebGL とは別の API になりますが、WebVR などの新しいウェブの世界を彩る API にも、やはり WebGL の進化はプラスになります。

ウェブの持つ役割がどんどんネイティブアプリケーションの特権を奪っていくような風潮がありますが、WebGL の進化も、そういう大きな流れのひとつなのかもしれません。

---

#### まとめ

3D プログラミングの難しさがそのまま WebGL の難しさに直結するため、API の持つ細かな部分までを把握して使いこなすのは、やはり大変です。

しかし、three.js や Unity など、WebGL に関連したソリューションを利用して WebGL と向き合っていくこともまた、ウェブ上でなにかを表現していくという意味においては、スクラッチで WebGL を扱うこととなにひとつ変わらない意義があります。

---

#### まとめ

今後、みなさんがどのようにウェブの表現と向き合っていくのかはわかりませんが、ぜひ WebGL の可能性や、自分に合った WebGL の利用の仕方を模索してみていただけましたらうれしいです。

まあ個人的には、スクラッチ WebGL おじさんがたくさん増えてくれたらそれこそ一番うれしいかもしれませんが（笑）

---

#### まとめ

<span class="capt">ありがとうございました！</span>

---


